<!doctype html>
<html data-n-head-ssr data-n-head="">
  <head data-n-head="">
    <title data-n-head="true">CNode：Node.js专业中文社区</title><meta data-n-head="true" charset="utf-8"><meta data-n-head="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="true" name="renderer" content="webkit"><meta data-n-head="true" data-hid="keywords" name="keywords" content="vue, nuxt, nuxt2, nodejs, node, express, connect, socket.io"><meta data-n-head="true" data-hid="author" name="author" content="ly2011"><meta data-n-head="true" data-hid="description" name="description" content="CNode：Node.js专业中文社区"><link data-n-head="true" rel="icon" type="image/x-icon" href="/favicon.ico"><base href="/nuxt-blog/"><link rel="preload" href="/nuxt-blog/_nuxt/9c11529915801e3bf16a.js" as="script"><link rel="preload" href="/nuxt-blog/_nuxt/0a520300744ac3f1fc51.js" as="script"><link rel="preload" href="/nuxt-blog/_nuxt/928ab6f72fb877e28078.css" as="style"><link rel="preload" href="/nuxt-blog/_nuxt/57fb3943be9a93db42b4.js" as="script"><link rel="preload" href="/nuxt-blog/_nuxt/8a5b7742a07f1d23fe1f.css" as="style"><link rel="preload" href="/nuxt-blog/_nuxt/0ee71a772b0f3afbf38d.js" as="script"><link rel="preload" href="/nuxt-blog/_nuxt/a07df16d0f1ead9adc20.css" as="style"><link rel="preload" href="/nuxt-blog/_nuxt/33ffe1be6688f2a23cd1.js" as="script"><link rel="stylesheet" href="/nuxt-blog/_nuxt/928ab6f72fb877e28078.css"><link rel="stylesheet" href="/nuxt-blog/_nuxt/8a5b7742a07f1d23fe1f.css"><link rel="stylesheet" href="/nuxt-blog/_nuxt/a07df16d0f1ead9adc20.css">
  </head>
  <body data-n-head="">
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><div class="navbar" data-v-93f336d8><div class="navbar-inner" data-v-93f336d8><div class="navbar-container" data-v-93f336d8><a href="javascript:;" class="brand" data-v-93f336d8><img src="/nuxt-blog/_nuxt/img/86f6a7c.svg" alt="cnodejs" data-v-93f336d8></a> <ul class="nav" data-v-93f336d8><li data-v-93f336d8><a href="/nuxt-blog/" class="nuxt-link-exact-active nuxt-link-active" data-v-93f336d8>
              首页
            </a></li><!----><li data-v-93f336d8><a href="/nuxt-blog/" class="nuxt-link-exact-active nuxt-link-active" data-v-93f336d8>
              新手入门
            </a></li><li data-v-93f336d8><a href="/nuxt-blog/" class="nuxt-link-exact-active nuxt-link-active" data-v-93f336d8>
              API
            </a></li><li data-v-93f336d8><a href="/nuxt-blog/" class="nuxt-link-exact-active nuxt-link-active" data-v-93f336d8>
              关于
            </a></li><li data-v-93f336d8><a href="/nuxt-blog/" class="nuxt-link-exact-active nuxt-link-active" data-v-93f336d8>
              设置
            </a></li><li data-v-93f336d8><a href="/nuxt-blog/register" data-v-93f336d8>
              注册
            </a></li><li data-v-93f336d8><a href="/nuxt-blog/login" data-v-93f336d8>
              登录
            </a></li><!----></ul></div></div></div> <section class="topics-container container" data-v-57b294f8><div id="main" class="clearfix" data-v-57b294f8><aside id="sidebar" data-v-39c1c0b3 data-v-57b294f8><div class="el-card box-card is-always-shadow" data-v-39c1c0b3><div class="el-card__header"><div class="box-card-header" data-v-39c1c0b3><span data-v-39c1c0b3>CNode：Node.js专业中文社区</span></div></div><div class="el-card__body"> <div class="box-card-content login-box" data-v-39c1c0b3><div class="box-card-content-header" data-v-39c1c0b3>
        您可以
        <a href="/nuxt-blog/login" data-v-39c1c0b3>
          登录
        </a>
        或
        <a href="/nuxt-blog/register" data-v-39c1c0b3>
          注册
        </a>，也可以
        <button type="button" class="el-button el-button--primary" data-v-39c1c0b3><!----><!----><span>通过 GitHub 登录</span></button></div></div></div></div> <!----> <!----></aside> <div id="content" data-v-57b294f8><header class="header" data-v-57b294f8><div class="el-tabs el-tabs--top" data-v-57b294f8><div class="el-tabs__header is-top"><div class="el-tabs__nav-wrap is-top"><div class="el-tabs__nav-scroll"><div role="tablist" class="el-tabs__nav is-top" style="transform:translateX(0)"><div class="el-tabs__active-bar is-top"></div></div></div></div></div><div class="el-tabs__content"><div role="tabpanel" aria-hidden="true" id="pane-null" aria-labelledby="tab-null" class="el-tab-pane" style="display:none" data-v-57b294f8></div><div role="tabpanel" aria-hidden="true" id="pane-good" aria-labelledby="tab-good" class="el-tab-pane" style="display:none" data-v-57b294f8></div><div role="tabpanel" aria-hidden="true" id="pane-share" aria-labelledby="tab-share" class="el-tab-pane" style="display:none" data-v-57b294f8></div><div role="tabpanel" aria-hidden="true" id="pane-ask" aria-labelledby="tab-ask" class="el-tab-pane" style="display:none" data-v-57b294f8></div><div role="tabpanel" aria-hidden="true" id="pane-job" aria-labelledby="tab-job" class="el-tab-pane" style="display:none" data-v-57b294f8></div><div role="tabpanel" aria-hidden="true" id="pane-dev" aria-labelledby="tab-dev" class="el-tab-pane" style="display:none" data-v-57b294f8></div></div></div></header> <div class="table-list" data-v-57b294f8><div class="el-table el-table--fit el-table--enable-row-hover el-table--enable-row-transition" style="width:100%" data-v-57b294f8><div class="hidden-columns"><div data-v-57b294f8></div> <div data-v-57b294f8></div> <div data-v-57b294f8></div> <div data-v-57b294f8></div> <div data-v-57b294f8></div> <div data-v-57b294f8></div></div><div class="el-table__header-wrapper"><table cellspacing="0" cellpadding="0" border="0" class="el-table__header"><colgroup></colgroup><thead><tr></tr></thead></table></div><div class="el-table__body-wrapper is-scrolling-none"><table cellspacing="0" cellpadding="0" border="0" class="el-table__body"><colgroup></colgroup><tbody><tr class="el-table__row"></tr><tr class="el-table__row"></tr><tr class="el-table__row"></tr><tr class="el-table__row"></tr><tr class="el-table__row"></tr><tr class="el-table__row"></tr><tr class="el-table__row"></tr><tr class="el-table__row"></tr><tr class="el-table__row"></tr><tr class="el-table__row"></tr><tr class="el-table__row"></tr><tr class="el-table__row"></tr><tr class="el-table__row"></tr><tr class="el-table__row"></tr><tr class="el-table__row"></tr><!----></tbody></table><!----><!----></div><!----><!----><!----><!----><div class="el-table__column-resize-proxy" style="display:none"></div></div> <div class="pagination" data-v-57b294f8><div class="el-pagination" data-v-57b294f8><span class="el-pagination__total">共 1000 条</span><button type="button" disabled class="btn-prev"><i class="el-icon el-icon-arrow-left"></i></button><ul class="el-pager"><li class="number active">1</li><!----><li class="number">2</li><li class="number">3</li><li class="number">4</li><li class="number">5</li><li class="number">6</li><li class="el-icon more btn-quicknext el-icon-more"></li><li class="number">67</li></ul><button type="button" class="btn-next"><i class="el-icon el-icon-arrow-right"></i></button><span class="el-pagination__jump">前往<div class="el-input el-pagination__editor is-in-pagination"><!----><input type="number" autocomplete="off" min="1" max="67" value="1" class="el-input__inner"><!----><!----><!----></div>页</span><button type="button" class="el-button jump-page-btn el-button--primary el-button--small" data-v-57b294f8><!----><!----><span>
              跳转
            </span></button></div></div></div></div></div></section></div></div></div><script>window.__NUXT__=function(r,n,t,e,a,o,s,i,c,p){return{layout:"default",data:[{}],error:null,state:{topic:{topic:{},loading:r},topics:{topics:[{id:"5c2edce13898674067a7b103",author_id:"5372465f3c72496d41009adc",tab:n,content:"截止1 月 12日晚 22:00，有效参与人数共 252 人，抽取 5 名中奖者。\r\n恭喜以下中奖者🎉🎉🎉🎉🎉 gofromzero,MoeXian,yxcs,caoxiaoshuai1,langjy🎉🎉🎉🎉🎉\r\n请评论区留下联系方式。\r\n![image.png](//static.cnodejs.org/Fvx9s9EjQk7IwNrAMO5_y7zJfrej)\r\n\r\n---------------- 以下是原文 ----------------\r\n\r\n新书《Node.js开发实战》热卖，大获好评，感谢大家的支持，送几本书回馈给大家。\r\n\r\n赠书办法：\r\n* 只须在本贴留言即可。\r\n* 从回贴评论者中随机抽取中奖者，共计 5 本，每位中奖者 1 本。\r\n* 获赠名单公布在本帖，并在本贴下评论 @ 每位获赠的同学。\r\n* 截止时间 2019 年 1 月 12 日 22:00:00 （ UTC+8 ），以评论时间为准。\r\n* 由于本站不支持私信，请获奖同学在本帖回复联系方式，邮箱或者任何其它能联系到你的形式。\r\n* 开奖后 72 小时未能回复联系方式者视为放弃。\r\n\r\n试读样章：[https://pan.baidu.com/s/1x3c35AmJV4rcEj_W3A1WGg](https://pan.baidu.com/s/1x3c35AmJV4rcEj_W3A1WGg)\r\n京东有售：[https://item.jd.com/12460185.html](https://item.jd.com/12460185.html)\r\n![WechatIMG148 copy.jpg](//static.cnodejs.org/Finp2H7di-Equ_yMWsjJY6hxYGkh)",title:"送几本《Node.js开发实战》",last_reply_at:"2019-01-28T09:49:17.339Z",good:r,top:e,reply_count:309,visit_count:6299,create_at:"2019-01-04",author:{loginname:"meikidd",avatar_url:"https://avatars0.githubusercontent.com/u/376338?v=4&s=120"}},{id:"5c1760337ec239239ff579a2",author_id:"54009f5ccd66f2eb37190485",tab:n,content:"北京1月12日Node Party活动视频地址：https://edu.talkingdata.com/open-class\r\n\r\n\r\nNode Party 是社区发起的一个面向 Node.js 和大前端爱好者的非商业，社区驱动的技术分享聚会，希望能够构建一个持续的分享学习平台，一起发展大前端生态。\r\n\r\n北京1月12日Node Party线下活动（周六）下午2点到6点，将近100人\r\n\r\n- 主题分享（已确认，共5个主题：3个Node.js主题，一个运维，一个前端）\r\n\t- 《重新认识Nodejs后端开发》 eggjs + React + SSR 做同构直出（去哪儿）\r\n\t- 《用mqtt协议实现nodejs长连接服务》Nodejs长连接，主要是性能和协议改造方面的（新浪）\r\n\t- 《浅谈nodejs异步那点事》（360）\r\n\t- 结合Node.js讲一下Docker 实践和原理（网易）\r\n\t- iview作者：如何做好一个开源项目（TalkingData）\r\n- 视情况可以考虑晚上AA聚\r\n\r\n时间：北京1月12日（周六）下午2点到6点\r\n地点：东直门TalkingData赞助的502教室\r\n人数：最多100人\r\n直播地址：https://live.bilibili.com/1353202\r\n\r\n现场还有 @justjavac，@小爵，@快手天翔 @王龑 等大咖。\r\n\r\n图灵出版社赞助了20本书，现场送给大家\r\n\r\n## 日程安排\r\n\r\n每个主题分享+答疑共45分钟，5个主题分享：3个Node.js主题，一个运维，一个前端\r\n茶歇5分钟（北京乐至道科技有限公司赞助茶歇，已经京东到会场）\r\n圆桌会议30分钟\r\n\r\n2:00-2:45\r\n刘露颖：《用mqtt协议实现nodejs长连接服务》Nodejs长连接，主要是性能和协议改造方面的（新浪）\r\n\r\n2:45-3:30\r\n张晋涛：《结合Node.js讲一下Docker 实践和原理》（网易）\r\n\r\n3:30-4:15\r\niView作者Aresn：如何做好一个开源项目（TalkingData）\r\n\r\n茶歇5分钟，感谢北京乐至道科技有限公司。DaDEX.io基于EOS公链开发，链上合约自动执行，全部交易上链，率先实现去中心化交易、高并发、低手续费、资金安全、最高交易透明的真去中心化交易所范式，无需注册、认证等繁琐流程，个人钱包内一键交易。致力于完善EOS生态，服务EOS用户，与跨链技术的结合，向传统中心化交易所发起挑战\r\n\r\n4:20-4:50\r\n圆桌会议：畅想一下前端2019（大神待定）\r\n\r\n4:50-5:35\r\n兴百放：《重新认识Nodejs后端开发》 eggjs + React + SSR 做同构直出（去哪儿）\r\n\r\n5:35-6:10\r\n宋光宇：《浅谈nodejs异步那点事》（360）\r\n\r\n\r\n## 主题\r\n\r\n###  1）《重新认识Node.js后端开发》\r\n\r\n兴百放，先就职在美团外卖事业部，负责前后端分离，以及 Nodejs 推广工作。本着不管黑猫白猫，只要能解决现实业务问题，提高团队工作效率，就是好猫的原则，致力于让团队成员从重复，耗时，繁琐的一些工作中解放出来。\r\n\r\n随着前端行业的蓬勃发展，越来越多的技术团队，对前端的职责范围，也慢慢的延伸到后端。这里就分享一些在我们进行服务自治（BFF），以及接管传统后端职责一些沉淀和经验。内容主要包括如何做技术框架的选型，使用 egg 一些经验总结，和 eggjs + React + SSR 做同构直出等内容 。\r\n\r\n![兴百放.png](//static.cnodejs.org/FnS8WR95lO1Ff7KevyeHsDHuNCjp)\r\n\r\n### 2）《Docker 实践和原理》\r\n\r\n张晋涛，目前任网易有道资深运维开发工程师, 负责 DevOPS 实践落地及 Kubernetes 容器化平台及自动化平台的规划建设等。骨灰级 Linux/Vim 玩家，对 Docker， Kubernetes 及相关生态有大量实践及深入源码的研究。曾负责美图运维自动化平台体系建设。掘金小册《Kubernetes 从上手到实践》作者。\r\n\r\n随着 Kubernetes 等云原生技术的事实标准已经形成，容器化技术作为其重要的组成部分也被使用的越来越广泛。在我们的开发实践中，如何更好的利用容器化技术( Docker )来提升我们的开发，测试效率也是我们所关注的重点。 本次分享集中于如何用 Docker 提升我们的效率以及如何用好它。以 node 和 前端为入手点，希望能对大家有所帮助。\r\n\r\n![张晋涛.png](//static.cnodejs.org/FoVKIjHzQJqhwe6IgBWiw2BEWoX-)\r\n\r\n### 3）《浅谈Node.js异步那点事》\r\n\r\n宋光宇 360前端工程师 360视频云/360云盘@奇舞团，\r\n\r\nnodejs给前端赋予了更多的生命力，它的异步模型给他带来无限的潜力。\r\n今天通过libuv这个nodejs核心库来聊聊nodejs异步的那点事。\r\n\r\n![宋光宇.png](//static.cnodejs.org/FmlpCMQIdEjJBXaxDSLS77gpcdqw)\r\n\r\n### 4）iView作者：如何做好一个开源项目\r\n\r\nAresn，基于 Vue.js 的开源 UI 组件库 — iView 的作者。现担任大数据公司 TalkingData 前端架构师。著有《Vue.js实战》、《Vue.js组件精讲》。\r\nTopic：\r\n\r\n- iView 的故事\r\n- 第一批用户\r\n- 持续运营\r\n- 国际化\r\n- 让更多的人参与\r\n- 让 Robot 来做“坏人”\r\n- 赞助与商业化\r\n\r\n![梁灏.png](//static.cnodejs.org/FlPAOO-2v0z85GbQ5StQPcIo5ESN)\r\n\r\n### 5）《用mqtt协议实现Node.js长连接服务》\r\n\r\n刘露颖，曾就职搜狐视频，新浪博客，目前任职新浪移动团队资深前端开发工程师，负责nodejs相关的服务开发与维护、以及部分运维相关工作。致力于v8的研究，对c++与nodejs之间的关系有深厚兴趣，并付诸实践。\r\n\r\nmqtt协议随着各种手机app的普及，在移动互联网中有了广泛的应用，借着项目的实践过程，讲术如何更好的使mqtt与nodejs相结合，为现在越来越普遍的高并发场景提供长连接服务的解决方案。\r\n\r\n![刘露颖.png](//static.cnodejs.org/FtVeXBznM2mqBtcxdDQEiC13R_xj)\r\n\r\n## 微信群\r\n\r\n群满100人后无法加群的, 添加我微信 mcdongWang 备注 node party 北京 我回拉你进群\r\n\r\n![31545188678_.pic.jpg](//static.cnodejs.org/FvqZCML0PfbFHt6xknAhJmkWKDPU)\r\n\r\n\r\n公众号文章地址\r\n\r\nhttps://mp.weixin.qq.com/s?__biz=MzAxMTU0NTc4Nw==&mid=2661157727&idx=1&sn=0b7a6aa495fbe3afe4a4d3774faf8706&chksm=80d5d68bb7a25f9d125e17ff08d1f373435db4a8a7fe2d074f4fbe58c517beb93266e08a4295&token=1373872492&lang=zh_CN#rd",title:"【\b活动+视频】北京1月12日Node Party活动",last_reply_at:"2019-01-28T04:35:22.027Z",good:r,top:e,reply_count:46,visit_count:5842,create_at:"2018-12-17",author:{loginname:"i5ting",avatar_url:"https://avatars3.githubusercontent.com/u/3118295?v=4&s=120"}},{id:"5bd4772a14e994202cd5bdb7",author_id:"504c28a2e2b845157708cb61",tab:n,content:"2018年10月27日晚上，突然收到服务器不能访问的告警通知，拜托了狼叔 @i5ting 帮忙看看，结果登不上也ping不通。\r\n后来收到短信，发现是被ucloud封了，短信内容如下：\r\n\r\n> 【UCloud】尊敬的UCloud用户，您的IP：123.59.77.142  存在URL ：https://cnodejs.org/topic/57239bce5a26c4a841ecbf01 （详细信息请查看邮箱）包含违禁内容（包括但不限于翻墙等），违反了国家有关法律法规。目前依主管单位要求，对您的IP予以封停，请您尽快处理违规内容。待处理完成后请联系技术支持重新开启业务。[4000188113]\r\n\r\n然后联系了ucloud的客服，一下就打通了，对方态度挺好处理问题也快。ucloud说是运营商那边封的，不是他们的检测机制。所以需要联系运营商解决。\r\n考虑到各位亲爱的网友们的行为我无法控制，那么一直跟越来越严格的审查系统对抗只会让自己疲惫，所以我就站点迁到国外。来到了aws jp。\r\n\r\n我大致测了测，电信和移动的访问速度非常快，100ms以内，联通会慢一点，400ms以内吧。\r\n\r\n建议翻墙访问。",title:"服务器迁移至 aws 日本机房",last_reply_at:"2019-01-24T07:46:22.699Z",good:r,top:e,reply_count:122,visit_count:13018,create_at:"2018-10-27",author:{loginname:"alsotang",avatar_url:"https://avatars1.githubusercontent.com/u/1147375?v=4&s=120"}},{id:"5c4ebbb23819b801aa5a20cd",author_id:"5b5d6fef58db3ccf66a4501e",tab:t,content:"看了一篇介绍js引擎的写的很详细,下面第一篇。\r\n[js引擎超详细介绍](https://segmentfault.com/a/1190000012925872)。\r\n[从输入url到服务器返回页面,整个过程经历了什么,超完整,超详细](https://zhuanlan.zhihu.com/p/34453198)\r\n第二个能验证你的前端是否体系完整！！！\r\n但,我看完还有一个疑问,链接中提到：**js是单线程的,只有当所有同步任务执行完,才会执行异步任务**。\r\n### 我的问题：那异步方式优势是什么呢？\r\n1. 异步写法：\r\n```\r\nconst fs = require('fs');\r\nfs.writeFile('test.txt', 1234567899876543210, 'utf8', function (err) {\r\n  if (err) throw err;\r\n  else console.log('写完成');\r\n});\r\nfor(let i = 0;i < 1000000;i++){\r\n  console.log( `hello=${i}` );\r\n}\r\n```\r\n2. 结果：文件夹`test.txt`会很快创建,但之后就一直输出`hello=···`,直到最后才会在`test.txt`中写入内容,并输出`写完成`。\r\n3. 同步写法：\r\n```\r\nconst fs = require('fs');\r\nfor(let i = 0;i < 1000000;i++){\r\n  console.log( `hello=${i}` );\r\n}\r\nfs.writeFileSync('test.txt', 1234567899876543210, 'utf8');\r\nconsole.log('写完成');\r\n```\r\n### 我的问题：异步写法与同步写法有什么区别呢？在性能上？仅仅是写的时候顺序不同么？\r\n### 虽然是老生常谈的问题,但自己一直不是特别懂到底异步好在哪里,之前只是人云亦云的用,求解答？",title:"js引擎是单线程,那异步有什么优势呢?",last_reply_at:"2019-01-30T09:28:45.785Z",good:r,top:r,reply_count:13,visit_count:477,create_at:c,author:{loginname:"ailuhaosi",avatar_url:"https://avatars3.githubusercontent.com/u/30113164?v=4&s=120"}},{id:"5c4fffe0a4647e02328f206f",author_id:"52c005d28a716e0b1578f9cc",tab:n,content:"大家好，很开心在这里宣布 YodaOS 开源了。他将承载 Rokid 4年以来对于人工智能和语音交互领域的沉淀，并选择 Node.js 作为操作系统的一等开发公民，全部开放给社区。\r\n\r\n![yoda-arch.png](//static.cnodejs.org/FonFMOGJSL2v_OCVBkKULbZs2IJR)\r\n\r\nYodaOS 的架构跟 Android 类似，从下至上，由 Linux Kernel、系统服务和应用框架组成。不过 YodaOS 有以下不同：\r\n\r\n- 开发者可以直接使用 JavaScript / Node.js 来开发本地应用（技能）；\r\n- 封装了 AI 抽象层，可以通过 JavaScript 直接调用到诸如语音激活、语音识别、人脸识别等接口；\r\n\r\n除了支持默认的 Node.js API 外，YodaOS 还提供：\r\n\r\n- 内置的语音激活和语音识别 API，真正做到了开箱即用（开发）的语音交互系统；\r\n- 对音量控制、电源管理、蓝牙、多媒体播放、LED 灯效和 OTA 等都进行了接口封装；\r\n- 对物联网开发者来说，内置了标准化的 WebSocket、MQTT 等物联网协议的客户端实现；\r\n\r\nYodaOS 也支持 npm 仓库，开发者可以根据自己的需要在 OS 中运行所需的模块，不过并不推荐使用一些实现起来很重的模块，因为 YodaOS 需要支持中低端设备，所以有时候也需要考虑到性能方面的因素。\r\n\r\n如果遇到一些 npm 仓库确实实现很重，但又不得不用的时候，在 YodaOS 上，我们一般的做法是使用 N-API 桥接 C/C++ 模块，然后保证 JavaScript API 与对应的 npm 包一致。\r\n\r\n同时借助于 N-API，开发者可以将任何 Linux 的库移植到 YodaOS 上，并通过 N-API 以 JavaScript API 方式使用，可以这么理解，N-API 之于 YodaOS，就像 JNI 之于 Android。\r\n\r\n![yoda-nodejs.png center](//static.cnodejs.org/FkOaVJ5f8rc8m3a_be8D0uQpuBJM)\r\n\r\n### 为什么是 Node.js\r\n\r\n前面提到了 YodaOS 选择拥抱 Node.js 和 Node.js 开发者，最大的一个原因就是在过去将近10年的时间，从最开始 Ryan Dahl 定义的，一个轻量级的 Web 服务器框架，到如今的 Express、Loopback、Koajs、Midway 和 Egg Framework，在 Web 服务器框架领域已经渐渐成熟。\r\n\r\n依托于 Node.js 提供的运行时，从 Grunt、Gulp 到现在的 Webpack 和 Parcel，在构建工具领域，社区也不断涌现出非常卓越的开源项目来。Node.js 正在发挥每位开发者的想象力，社区中几乎有你需要的一切，甚至于在社区中，有一句流传已久的名言：\r\n\r\n> “any application that can be written in JavaScript, will eventually be written in JavaScript” ——Atwood’s Law\r\n\r\n意思就是说，只要能被 JavaScript 来编写的程序，终将使用 JavaScript 实现。那为什么不用 JavaScript 来写一个操作系统呢？\r\n\r\n当然上面的只是一个有趣的引子，Rokid 真正想做的是让 Node.js 开发者能够以更低的门槛进入语音交互和嵌入式领域。\r\n\r\n### Node.js 与 ShadowNode\r\n\r\nYodaOS 虽然跟 Android 的架构相似，不过解决的问题，及目标设备并不尽然相同，对于现在越来越便宜的手机，Android 开发者几乎不用担心系统性能的问题。然而对于像智能音响、IoT 终端以及其他嵌入式设备，通常硬件资源都是非常紧缺的，在这种情况下，OS 就要解决开发者“既要节省资源、又要便于开发”的问题。\r\n\r\n于是针对中低端硬件产品（内存介于 128MB 到 256MB 之间），我们创造了 ShadowNode 来解决这个问题，它是 Rokid 基于三星 IoT.js 二次开发的一款 Node.js 运行时，它具备更快的启动速度和更低的资源占用，相比 IoT.js，它：\r\n\r\n- 提供了更好的错误栈信息和性能调试工具；\r\n- 支持了基于 N-API 的跨运行时模块执行；\r\n- 针对特定芯片的性能优化，比如 AmLogic A113 和 Kamino18；\r\n\r\n借助于 N-API 的 ABI 兼容特性，我们实现了 OS 上层框架和应用的运行时兼容性。比如开发者完全可以选择在更高级的设备上运行 YodaOS，此时内存和 Flash 不再是瓶颈，开发者只需要更换系统中的 Node.js 运行时，即可获得更快的执行速度，不需要修改一行上层代码。\r\n\r\n### 最后\r\n\r\n我们希望借助 YodaOS，为 Node.js 社区补全终端开发这一版图，让我们用这门亲切的语言，再次回到我们熟悉的“端”的开发。\r\n\r\n如果想一起加入 YodaOS，可以在 GitHub 上关注我们，项目地址：https://github.com/yodaos-project/yodaos",title:"YodaOS：一个属于 Node.js 社区的操作系统",last_reply_at:"2019-01-30T09:25:09.185Z",good:e,top:r,reply_count:14,visit_count:501,create_at:a,author:{loginname:"yorkie",avatar_url:"https://avatars3.githubusercontent.com/u/1935767?v=4&s=120"}},{id:"5c5169953819b801aa5a2dd1",author_id:"58f837a3bbaf2f3f569be082",tab:n,content:"**作者：** 林水溶\r\n\r\n**博客：** [https://linshuirong.cn](https://linshuirong.cn/)\r\n\r\n\r\n\r\n> **为了大家都能看懂相声中我想表达的东西，先声明下：**\r\n>\r\n> 1. 今早咪蒙发表一篇文章：《一个出身寒门的状元之死》（槽点满满）\r\n> 2. 咪蒙曾发表过一篇文章：《我为什么支持实习生休学？》（槽点满满 plus）\r\n\r\n\r\n\r\n**进入正文：**\r\n\r\n---\r\n\r\n> 实习生小A，来咪蒙老师公司三个月了。前段时间听从咪老师建议休了学，全职投入到了工作之中。\r\n>\r\n> 实习生小B，刚来公司一周。受到小A学长和咪老师的鼓舞，也过段时间休学的打算。\r\n\r\n\r\n\r\n实习生小A：小B啊，你在这儿好好干。我准备联系下学校，看还能不能继续回去上学...（悲伤脸）\r\n\r\n实习生小B：你这咋回事儿啊？（震惊脸）\r\n\r\n实习生小A：唉...这个事儿吧，还得从前两天说起。（悲伤脸）前两天咪蒙老师给我安排个活儿。\r\n\r\n实习生小B：啥活啊？\r\n\r\n实习生小A：她让我给篇文章拟个标题，说准备发一篇爆款文章，让我给拟个配得上它身份的标题。\r\n\r\n实习生小B：那你就拟个呗，这有啥难的？小学三年级我们就开始写作文了，还怕它一个标题？\r\n\r\n实习生小A：要有你说的这么简单就好了。\r\n\r\n实习生小B：怎么了，难道还有要求？（疑问脸）\r\n\r\n实习生小A：真有！咪老师提了三点要求。\r\n\r\n实习生小B：哪三点？\r\n\r\n实习生小A：**第一点：标题一定要引发好奇**\r\n\r\n实习生小B：这很有道理啊。（认真脸）\r\n\r\n实习生小A：还给我举了个例子：**《一夜之间，北京的井盖全消失了》**\r\n\r\n实习生小B：咦，这是怎么回事？北京的井盖怎么会在一夜之间全消失呢？（好奇脸）\r\n\r\n实习生小A：你看你看。只要是个人，看到这样的标题他都会好奇不是。\r\n\r\n实习生小B：有道理。但北京的井盖怎么会在一夜之间全消失呢？你说河南人…（纠结脸）\r\n\r\n实习生小A：打住打住，哪儿跟哪儿啊。井盖怎么消失的根本不重要好吗。重要的是这个标题能在第一时间抓住你的视线。\r\n\r\n实习生小B：怎么可能不重要啊？北京的井盖儿都消失了还不算重要啊？这一天得造成多少次交通事故啊。（萌新脸）\r\n\r\n实习生小A：你是真傻还是装傻啊？看不出来文章标题是故意夸大啊。你要是点开看，它肯定说只是北京某处的井盖消失了，哪儿能是全北京城啊。我早就跟你说了，不要刷抖音，刷抖音降智，你不听。你看看你现在成什么样子了…（不屑脸）\r\n\r\n实习生小B：去你的吧。我还刷知乎，学习新姿势呢，你怎么不说？（不服脸）\r\n\r\n实习生小A：知乎？“与世界分享你刚编的段子”，那个知乎啊。（不屑脸）\r\n\r\n实习生小B：人家那是“与世界分享你身边的故事”。\r\n\r\n实习生小A：扯远了扯远了。接着说**第二点要求：标题一定要简单粗暴**\r\n\r\n实习生小B：简单粗暴这个我会。不就是“说大白话”吗？是个人都会吧。\r\n\r\n实习生小A：是说“大白话”，也不是说“大白话”。\r\n\r\n实习生小B：那到底是不是“说大白话”啊？\r\n\r\n实习生小A：我也不知道。\r\n\r\n实习生小B：什么？你也不知道？那你还这么说！（生气脸）\r\n\r\n实习生小A：不是。这句话是那天咪老师说的。然后我也问她了，我说“咪老师，那到底是‘是’还是‘不是’啊？“\r\n\r\n实习生小B：咪老师怎么说？\r\n\r\n实习生小A：咪老师什么都没说，就直勾勾地瞪着我，足足有三分钟！然后说“第三点要求...”\r\n\r\n实习生小B：这...\r\n\r\n实习生小A：唉，实习生真不好做。（轻声叹息：早知道不休学了...）（苦逼脸）\r\n\r\n实习生小B：那第三个要求是啥？\r\n\r\n实习生小A：哦，**第三点要求是：标题一定要颠覆常识**\r\n\r\n实习生小B：什么叫颠覆常识？\r\n\r\n实习生小A：给你举个例子：**《你这么真诚，一定是骗子！》**\r\n\r\n实习生小B：这是什么混蛋逻辑啊。真诚招你惹你了，就一定是骗子啊。（愤怒脸）\r\n\r\n实习生小A：别着急骂先。你看看它算不算是“颠覆常识”。\r\n\r\n实习生小B：… 还真算（尴尬脸）\r\n\r\n实习生小A：这就对了。读者看到这样的标题，肯定会觉得气。\r\n\r\n实习生小B：胡说八道，肯定气啊。\r\n\r\n实习生小A：只要一生气，那可就着了道了。鲁迅曾说：“你对待情绪的方式，决定了你生活的层次”（认真脸）\r\n\r\n实习生小B：鲁迅说过这话？（好奇脸）\r\n\r\n实习生小A：说过啊，不信你去Google！（严肃脸）\r\n\r\n实习生小B：Google上不去，算了，信你一回。（悻悻脸）\r\n\r\n实习生小A：三点建议呢，就是这样。晚上下班到家后，我饭也顾不上吃，就想啊。最后绞尽脑汁地想了一宿，才想出来个我觉得完全符合咪老师要求的标题。然后第二天一大早就来到老师办公室，把标题交了上去。（疲惫脸）\r\n\r\n实习生小B：然后呢？\r\n\r\n实习生小A：然后？然后我被辞了。\r\n\r\n实习生小B：被…被辞了？就因为这件破事儿？（震惊脸）\r\n\r\n实习生小A：嗯。\r\n\r\n实习生小B：那你交上去的是啥标题啊？\r\n\r\n实习生小A：**《一夜之间，寒门出身的状元周有择死了，一定是在骗你！》**",title:"写了段相声：一个休学的实习生的被裁经历（为了吐槽今早朋友圈被刷屏的咪蒙文章《一个出身寒门的状元之死》）",last_reply_at:"2019-01-30T09:08:37.014Z",good:r,top:r,reply_count:0,visit_count:36,create_at:s,author:{loginname:"shuiRong",avatar_url:"https://avatars1.githubusercontent.com/u/16076993?v=4&s=120"}},{id:"5c4fef27a4647e02328f1fe7",author_id:"5c4fedae3819b801aa5a261a",tab:t,content:"开源地址：https://github.com/yodaos-project/yodaos",title:"如何评价rokit近期开源的YodaOS？",last_reply_at:"2019-01-30T08:47:36.895Z",good:r,top:r,reply_count:2,visit_count:219,create_at:a,author:{loginname:"PotentialSteffan",avatar_url:"https://avatars1.githubusercontent.com/u/24876673?v=4&s=120"}},{id:"5c5161303819b801aa5a2d79",author_id:"5735889dc3e4ef7657ab12f1",tab:t,content:"https://telegraf.js.org/#/\r\n看到了,这个, 有做过相关东西的小伙伴吗?",title:"nodejs写telegram bot",last_reply_at:"2019-01-30T08:32:48.541Z",good:r,top:r,reply_count:0,visit_count:42,create_at:s,author:{loginname:"vipzrx",avatar_url:"https://avatars1.githubusercontent.com/u/5094958?v=4&s=120"}},{id:"5c4930003b948a2b4ab710a6",author_id:"5c4926b16955112b99438477",tab:t,content:"目前的项目是一个App应用，后端API采用egg.js框架。\r\n现在有这样一个需求\r\n\r\n业务场景：\r\n- API服务发送消息到阿里云消息服务 (MNS)\r\n- 需要一个服务，获取阿里云消息服务(MNS)队列的消息，然后进行相关的业务处理\r\n- 需要多个服务处理不同的业务 (比如发送短信，帖子新回复的提醒)\r\n\r\n考虑用egg.js框架的扩展定时任务+阿里云消息服务(MNS)长轮询\r\n\r\n代码示例:\r\nhttps://github.com/jerryhu/egg-mns-long-polling-experiment\r\n\r\ntask部分的代码如下:\r\n```js\r\n'use strict';\r\nmodule.exports = {\r\n  schedule: {\r\n    type: 'mns',\r\n  },\r\n  async task(ctx, message) {\r\n    console.log(`task1: ${message}`);\r\n\r\n    const condition = true;\r\n    while (condition) {\r\n      try {\r\n        // 获取消息\r\n        const resp = await ctx.app.alicloudMns.receiveMessage('test-post-reminder-queue', 25);\r\n        const data = Buffer.from(resp.body.MessageBody, 'base64').toString('utf8');\r\n        console.log(`data: ${data}`);\r\n\r\n        // TODO: 新评论提醒\r\n\r\n        // 删除消息\r\n        await ctx.app.alicloudMns.deleteMessage('test-post-reminder-queue', resp.body.ReceiptHandle);\r\n      } catch (err) {\r\n        if (err.name === 'MNSMessageNotExistError') {\r\n          console.log(`没有消息: ${new Date()}`);\r\n          continue;\r\n        }\r\n\r\n        console.error(`获取消息出错 ${err.stack}`);\r\n        break;\r\n      }\r\n    }\r\n  },\r\n};\r\n```\r\n\r\n问题:\r\n1. 扩展定时任务中长时间执行任务是否可行？\r\n2. 有没有更优的解决方案（nodejs后端服务应用+阿里云MNS长轮询）？",title:"[egg.js] 扩展定时任务与阿里云消息服务MNS长轮询",last_reply_at:"2019-01-30T08:20:45.614Z",good:r,top:r,reply_count:10,visit_count:533,create_at:"2019-01-24",author:{loginname:"jerryhu",avatar_url:"https://avatars2.githubusercontent.com/u/1637137?v=4&s=120"}},{id:"5c4e9d1fa4647e02328f1a0c",author_id:"5c2e23963898674067a7ae2b",tab:t,content:"需求大体就是发布一个二进制的 http 服务给用户使用，一共大约 4-5 个接口。\r\n调研了一下，有下面几种选择。\r\n1 electorn + express\r\n2 nodejs + express\r\n3 java + jre\r\n4 golang\r\n5 c++\r\n\r\njava 和 nodejs 跨平台很方便，但是都需要用户手动安装依赖。\r\nelectorn 的话安装包太大了。\r\n那么 golang 是不是最好的选择了。编译成二进制，什么平台都支持。",title:"如果要发布一个 http 服务，有比 golang 更好的选择吗？",last_reply_at:"2019-01-30T08:08:59.060Z",good:r,top:r,reply_count:5,visit_count:375,create_at:c,author:{loginname:"DiamondYuan",avatar_url:"https://avatars1.githubusercontent.com/u/9692408?v=4&s=120"}},{id:"5c51513ea4647e02328f271d",author_id:"58450b974c17b38d3543639c",tab:n,content:"# [souljs](https://github.com/my-soul/souljs)\r\n\r\nA nodejs web framework, 对koa简单包装，装饰风格，内置开发常用中间件，使用typescript编写\r\n\r\n## 安装\r\n\r\n``` bash\r\ngit clone https://github.com/my-soul/souljs-starter.git\r\n\r\nnpm install && npm run start\r\n```\r\nNode.js >= 8.0.0 required.\r\n\r\n## 快速开始\r\n\r\n#### 创建应用实例\r\n\r\n```typescript main.ts\r\nimport { createApplication } from 'souljs';\r\n\r\nasync function main() {\r\n  const app = await createApplication(__dirname, 'controller/*.ts');\r\n\r\n  app.listen(8080);\r\n}\r\n\r\nmain();\r\n```\r\n\r\n#### 路由处理并返回数据\r\n\r\n```typescript controller/user.ts\r\n@Controller('/user')\r\nexport default class User {\r\n\r\n  @Post('/chname')\r\n  changeName() {\r\n    return ‘hello world’;\r\n  }\r\n}\r\n```\r\n\r\n#### 通过@Render返回视图\r\n\r\n```typescript controller/user.ts\r\n@Controller('/user')\r\n@Use(Auth())\r\nexport default class User {\r\n\r\n  @Get()\r\n  @Render('user')\r\n  index() {\r\n    return { content: 'hi' };\r\n  }\r\n}\r\n```\r\n\r\n\r\n#### 请求参数验证\r\n\r\n```typescript\r\n@Controller('/user')\r\nexport default class User {\r\n\r\n  @Post('/chname')\r\n  @QuerySchame(joi.object().keys({\r\n    id: joi.string()\r\n  }))\r\n  @BodySchame(joi.object().keys({\r\n    name: joi.string().required()\r\n  }))\r\n  changeName(@Body() body: any, @Query() query: any) {\r\n    return ResultUtils.ok(body);\r\n  }\r\n}\r\n\r\n```\r\n\r\n#### 接口描述\r\n\r\n接口文档默认访问地址: /swagger-ui/index.html\r\n\r\n```typescript\r\n@Controller('/user')\r\n@ApiUseTags('user')\r\n@ApiDescription('用户信息')\r\nexport default class User {\r\n\r\n  @Post('/hi')\r\n  @ApiDescription('test')\r\n  test() {}\r\n}\r\n\r\n```\r\n\r\n## API\r\n\r\n### createApplication(root, controllers, options): Application\r\n\r\n- 参数\r\n  - { string } root - 项目路径\r\n  - { string | controller[] } controllers - 控制器的目录位置，使用globs匹配，或者是控制器类的数组\r\n  - { ApplicationOptions }  options - 参考如下ApplicationOptions, 值false不启用功能\r\n\r\n  ```typescript\r\n    interface ApplicationOptions {\r\n      staticAssets?: { root: string; prefix?: string } | boolean; // koa-static'\r\n      swagger?: { url: string; prefix?: string } | boolean; // swagger-ui\r\n      bodyparser?: Bodyparser.Options | boolean; // koa-bodyparser\r\n      session?: KoaSession.opts | boolean; // koa-session\r\n      hbs?: { viewPath?: string } | boolean; // koa-hbs\r\n      helmet?: object | boolean; // koa-helmet\r\n    }\r\n  ```\r\n- 返回值：Application\r\n\r\n\r\n### Application\r\n\r\n实例方法\r\n\r\n- use(mid: Koa.Middleware)\r\n\r\n- listen(port: number)\r\n\r\n- getKoaInstance(): Koa\r\n\r\n- getHttpServer(): http.Server\r\n\r\n\r\n### http请求装饰器\r\n\r\n内部使用koa-router中间件，提供对应的方法的装饰器\r\n\r\n- @Controller(string|void)\r\n\r\n- @POST(string|void)\r\n\r\n- @Get(string|void)\r\n\r\n### @Render(view: string) 模板渲染\r\n\r\n不能禁用hbs\r\n\r\n\r\n### 使用[Joi](https://www.npmjs.com/package/joi)验证请求参数\r\n\r\n- BodySchame(schame: joi.AnySchema)\r\n\r\n- QuerySchame(schame: joi.AnySchema)\r\n\r\n\r\n### 控制器处理方法参数注入\r\n\r\n```typescript\r\n@Post('/test')\r\ntest(@Body() Body: any, @Query() query: any) {}\r\n  \r\n ```\r\n \r\n 提供如下修饰器\r\n\r\n- @Ctx() - ctx\r\n- @Request() - ctx.request\r\n- @Response() - ctx.Response\r\n- @Query(string|void) - ctx.request.query[string] | ctx.request.query\r\n- @Body(string|void) - ctx.request.body[string] | ctx.request.body\r\n\r\n- @ApplicationInstance() - 当前应用实例\r\n- @KoaInstance() - 当前koa实例",title:"一个简单够用的node web框架",last_reply_at:"2019-01-30T07:24:46.853Z",good:r,top:r,reply_count:0,visit_count:77,create_at:s,author:{loginname:"my-soul",avatar_url:"https://avatars2.githubusercontent.com/u/12870303?v=4&s=120"}},{id:"5c46759e3b948a2b4ab70483",author_id:"58d140302c8bf2a836456213",tab:n,content:"**摘要：** JS的\"编译原理\"。\r\n\r\n- 原文：[JavaScript的工作原理：解析、抽象语法树（AST）+ 提升编译速度5个技巧](https://segmentfault.com/a/1190000017961297)\r\n- 作者：[前端小智](https://segmentfault.com/a/1190000017794020)\r\n\r\n**[Fundebug](https://www.fundebug.com/)经授权转载，版权归原作者所有。**\r\n\r\n这是专门探索 JavaScript 及其所构建的组件的系列文章的第 14 篇。\r\n\r\n如果你错过了前面的章节，可以在这里找到它们：\r\n\r\n- [JavaScript 是如何工作的：引擎，运行时和调用堆栈的概述！](https://segmentfault.com/a/1190000017352941)\r\n- [JavaScript 是如何工作的：深入V8引擎&编写优化代码的5个技巧！](https://segmentfault.com/a/1190000017369465)\r\n- [JavaScript 是如何工作的：内存管理+如何处理4个常见的内存泄漏 !](https://segmentfault.com/a/1190000017392370)\r\n- [JavaScript 是如何工作的：事件循环和异步编程的崛起+ 5种使用 async/await 更好地编码方式！](https://segmentfault.com/a/1190000017419328)\r\n- [JavaScript 是如何工作的：深入探索 websocket 和HTTP/2与SSE +如何选择正确的路径！](https://segmentfault.com/a/1190000017448270)\r\n- [JavaScript 是如何工作的：与 WebAssembly比较 及其使用场景 !](https://segmentfault.com/a/1190000017485968)\r\n- [JavaScript 是如何工作的：Web Workers的构建块+ 5个使用他们的场景!](https://segmentfault.com/a/1190000017578650)\r\n- [JavaScript 是如何工作的：Service Worker 的生命周期及使用场景!](https://segmentfault.com/a/1190000017749922)\r\n- [JavaScript 是如何工作的：Web 推送通知的机制!](https://segmentfault.com/a/1190000017794020?_ea=6014340#articleHeader0)\r\n- [JavaScript是如何工作的：使用 MutationObserver 跟踪 DOM 的变化!](https://segmentfault.com/a/1190000017832686)\r\n- [JavaScript是如何工作的：渲染引擎和优化其性能的技巧!](https://segmentfault.com/a/1190000017872125#articleHeader0)\r\n- [JavaScript是如何工作的：深入网络层 + 如何优化性能和安全!](https://segmentfault.com/a/1190000017903157)\r\n- [JavaScript是如何工作的：CSS 和 JS 动画底层原理及如何优化它们的性能！](https://segmentfault.com/a/1190000017927665)- \r\n\r\n### 概述\r\n\r\n我们都知道运行一大段 JavaScript 代码性能会变得很糟糕。这段代码不仅需要通过网络传输，而且还需要解析、编译成字节码，最后执行。在之前的文章中，我们讨论了 JS 引擎、运行时和调用堆栈等，以及主要由谷歌 Chrome 和 NodeJS 使用的V8引擎。它们在整个 JavaScript 执行过程中都发挥着至关重要的作用。这篇说的抽象语法树同样重要:在这我们将了解大多数 JavaScript 引擎如何将文本解析为对机器有意义的内容，转换之后发生的事情以及做为 Web 开发者如何利用这一知识。\r\n\r\n### 编程语言原理\r\n\r\n那么，首先让我们回顾一下编程语言原理。不管你使用什么编程语言，你需要一些软件来处理源代码以便让计算机能够理解。该软件可以是解释器，也可以是编译器。无论你使用的是解释型语言(JavaScript、Python、Ruby)还是编译型语言(c#、Java、Rust)，都有一个共同的部分:将源代码作为纯文本解析为 **抽象语法树(abstract syntax tree, AST)** 的数据结构。\r\n\r\n**AST** 不仅以结构化的方式显示源代码，而且在语义分析中扮演着重要角色。在语义分析中，编译器验证程序和语言元素的语法使用是否正确。之后，使用 AST 来生成实际的字节码或者机器码。\r\n\r\n> 抽象语法树（abstract syntax tree 或者缩写为 AST），或者语法树（syntax tree），是源代码的抽象语法结构的树状表现形式，这里特指编程语言的源代码。和抽象语法树相对的是具体语法树（concrete syntaxtree），通常称作分析树（parse tree）。一般的，在源代码的翻译和编译过程中，语法分析器创建出分析树。一旦 AST 被创建出来，在后续的处理过程中，比如语义分析阶段，会添加一些信息。\r\n\r\n### AST 程序\r\n\r\nAST 不仅仅是用于语言解释器和编译器，在计算机世界中，它们还有多种应用。使用它们最常见的方法之一是进行静态代码分析。静态分析器不执行输入的代码，但是，他们仍然需要理解代码的结构。\r\n\r\n例如，你可能想要实现一个工具，该工具可以找到公共代码结构，以便你可以重构它们以减少重复。你可能会通过使用字符串比较来实现这一点，但这个会相当简单且有局限性。\r\n\r\n当然，如果你对实现这样的工具感兴趣，你不需要编写自己的解析器。有许多与 Ecmascript规范完全兼容的开源项目。**Esprima** 和 **Acorn** 即是黄金搭档，还有许多工具可以帮助解析器生成输出，即 **ASTs** ，ASTs 被广泛应用于代码转换。\r\n\r\n例如，你可能希望实现一个将 Python 代码转换为J avaScript 的转换器。基本思想是使用Python 转换器生成 AST，然后使用 AST 生成JavaScript代码。\r\n\r\n你可能会觉得难以置信，事实是 ASTs 只是部分语言的不同表示法。在解析之前，它被表示为遵循一些规则的文本，这些规则构成了一种语言。在解析之后，它被表示为一个树结构，其中包含与输入文本完全相同的信息。因此，也可以进行反向解析然后回到文本。\r\n\r\n**代码部署后可能存在的BUG没法实时知道，事后为了解决这些BUG，花了大量的时间进行log 调试，这边顺便给大家推荐一个好用的BUG监控工具[Fundebug](https://www.fundebug.com/?utm_source=xiaozhi)。**\r\n\r\n### JavaScript 解析\r\n\r\n让我们看看 AST 是如何构建的。我们用一个简单的 JavaScript 函数作为例子:\r\n\r\n```javascript\r\nfunction foo(x) {\r\n    if (x > 10) {\r\n        var a = 2;\r\n        return a * x;\r\n    }\r\n\r\n    return x + 10;\r\n}\r\n```\r\n\r\n解析器会产生如下的 AST：\r\n\r\n![](https://image.fundebug.com/2019-01-21-01.png)\r\n\r\n注意，为了观看方便，这里是解析器将生成的结果的简化版本。实际的 AST 要复杂得多。然而，这里的目的是为了运行源码之前的第一个步骤前。如果人想查看实际的 AST 是什么样子，可以访问 [AST Explorer](https://astexplorer.net/)。它是一个在线工具，你以在其中输入一些 JavaScript 并输出对应的 AST。\r\n\r\n你可能会问，为什么需要知道 JavaScript解析器工作原理，毕竟这是浏览器工作，你想法是部分正确。下图展示了 JavaScript 执行过程中不同阶段的耗时。仔细瞅瞅，你或许会发现一些有趣的东西。\r\n\r\n![](https://image.fundebug.com/2019-01-21-02.png)\r\n\r\n发现没？ 通常情况下，浏览器解析 JavaScript 大约需占总执行时间的 `15%` 到 `20%`。我没有具体统计过这些数值。这些是来自真实应用程序和以某种方式使用 JavaScript 的网站的统计数据。也许 `15%` 看起来不是很多，但相信我，这是很多。\r\n\r\n一个典型的单页程序加载 0.4 mb 左右的 JavaScript，浏览器需要大约 `370ms` 来解析它。也许你会又说，这也不是很多嘛，本身花费的时间并不多。但请记住，这只是将 JavaScript 代码解析为 AST 所需要的时间。这并不包括运行本身的时间，也不包括在页面加载 ，如 CSS 和 HTML 渲染过程的耗时。这些还只涉及桌面，移动浏览器的情况会更加复杂，在手机上花在解析上的时间通常是桌面浏览器的 2 到 5 倍。\r\n\r\n![](https://image.fundebug.com/2019-01-21-03.jpeg)\r\n\r\n上图显示了 1MB JavaScript 包在不同类的移动和桌面浏览器解析时间。\r\n\r\n更重要的是，为了获得更多类原生的用户体验而把越来越多的业务逻辑堆积在前端，Web 应用程序正变得越来越复杂。你可以轻易地想到网络应用受到的性能影响。只需打开浏览器开发工具，然后使用该工具来解析、编译和浏览器中发生的所有其他事情上所消耗的时间。\r\n\r\n![](https://image.fundebug.com/2019-01-21-04.jpeg)\r\n\r\n不幸的是，移动浏览器上没有开发者工具。不过不用担心，这并不意味着你对此无能为力。因为有 [DeviceTiming](https://github.com/danielmendel/DeviceTiming) 工具,它可以用来帮助检测受控环境中脚本的解析和运行时间。它通过插入代码来封装本地代码，这样每次从不同的设备访问页面时，就可以在本地测量解析和运行时间。\r\n\r\n好事就是 JavaScript 引擎做了很多工作来避免冗余的工作，并得到了更好的优化，以下为主流浏览器使用的技术。\r\n\r\n例如，V8 实现脚本流(script streaming)和代码缓存技术。脚本流即脚本一旦开始下载，`async` 和 `deferred`的 脚本就会在单独的线程上解析。这意味着在下载脚本完成后几乎立即完成解析，这会提升 10% 的页面加载速度。\r\n\r\n每次访问页面时，JavaScript 代码通常编译为字节码。 然而，一旦用户访问另一页面，该字节码就被丢弃。 发生这种情况是因为编译后的代码很大程度上依赖于编译时机器的状态和上下文。 这是 Chrome 42 引入字节码缓存的原因。 该技术会本地缓存编译过的代码，这样当用户返回同一页面时，诸如下载，解析和编译等所有步骤都会被跳过。 这使得 Chrome 可以节省大约 40％ 的解析和编译时间。 此外，这还可以节省移动设备的电量。\r\n\r\n在 Opera 中，[Carakan](https://dev.opera.com/blog/carakan/) 引擎可以重用另一个程序最近编译过的输出。没有要求代码必须来自相同的页面甚至同个域下。这种缓存技术实际上非常高效，还可以完全跳过编译步骤。它依赖于典型的用户行为和浏览场景:每当用户在应用程序/网站中遵循某个用户的特定浏览习惯，都会加载相同的 JavaScript 代码。不过，Carakan 引擎早已被谷歌的 V8 所取代。\r\n\r\n> Opera 新的 JavaScript 引擎 “Carakan”，目前速度是其他已存在 JavaScript 引擎（基于 SunSpider）的2.5倍。其在转化为本地机器代码时专门针对正则表达式做了优化。\r\n\r\nFirefox 使用的 [SpiderMonkey](https://developer.mozilla.org/en-US/docs/Mozilla/Projects/SpiderMonkey) 引擎不会缓存所有内容。它可以过渡到监视阶段，在这个阶段中，它计算执行给定脚本的次数。基于此计算，它推导出频繁使用而可以被优化的代码部分。\r\n\r\n> SpiderMonkey 是 Mozilla 项目的一部分，是一个用 C 语言实现的 JavaScript 脚本引擎，另外还有一个叫做Rhino 的 Java 版本。\r\n\r\n显然，有些人决定什么都不做。Safari 的首席开发人员 [Maciej Stachowiak](https://en.wikipedia.org/wiki/Maciej_Stachowiak) 表示，Safari 不会对编译后的字节码进行任何缓存。缓存技术他们是有考虑过的问题，但是他们还没有实现，因为生成代码的耗时小于总运行时间的 2%。\r\n\r\n这些优化不会直接影响 JavaScript 源代码的解析，但是会尽可能完全避免。毕竟做总比没做好点？\r\n\r\n我们可以做很多事情来改善应用程序的初始加载时间。最小化加载的 JavaScript 数量：代码越小、解析所需要时间就越少，运行时间也就越小。要做到这一点，我们只能在当前的路由上加载所需的代码，而不是加载一大陀的代码。例如，[PRPL模式](https://developers.google.com/web/fundamentals/performance/prpl-pattern/)即表示该种代码传输类型。或者，可以检查代码的依赖关系，看看是否有什么冗余的依赖导致代码库膨胀，然而，这些东西需要很大的篇幅来进行讨论。\r\n\r\n本文的主要的目的讨论作为 Web 开发人员可以做些什么来帮助 JavaScript 解析器更快地完成它的工作。还有,现代JavaScript 解析器使用 **启发法(heuristics)** 来决定是否立即运行指定的代码片段或者推迟在未来的某个时候运行。基于这些启发法，解析器将进行即时或懒解析。\r\n\r\n> 启发法是针对模型求解方法而言的，是一种逐次逼近最优解的方法。这种方法对所求得的解进行反复判断实践修正直至满意为止。启发法的特点是模型简单，需要进行方案组合的个数少，因此便于找出最终答案。此方法虽不能保证得到最优解，但只要处理得当，可获得决策者满意的近似最优解。一般步骤包括:定义一个计算总费用的方法;报定判别准则;规定方案改选的途径;建立相应的模型;送代求解。\r\n\r\n立即解析会运行需要立即编译的函数。它主要做三件事:构建 AST，构建作用域层级和查找所有语法错误。另一方面， 懒解析只运行未编译的函数。它不构建AST，也不查找所有语法错误，它只构建作用域层级，与立即解析相比节省了大约一半的时间。\r\n\r\n显然，这不是一个新概念。即使像 IE 9 这样的浏览器也支持这种类型的优化，尽管与现在的解析器的工作方式相比，这种优化方式还很初级。\r\n\r\n来看一个例子，假设有以下代码片段:\r\n\r\n```javascript\r\nfunction foo() {\r\n    function bar(x) {\r\n        return x + 10;\r\n    }\r\n\r\n    function baz(x, y) {\r\n        return x + y;\r\n    }\r\n\r\n    console.log(baz(100, 200));\r\n}\r\n\r\nfoo()\r\n```\r\n\r\n就像前面的例子一样，代码被输入到语法分析器中，语法分析器进行语法分析并输出AST，如下：\r\n\r\n- 声明函数 `foo`\r\n- 调用函数 `foo`\r\n- 在 `foo` 里声明函数 `bar` 接收参数 `x`, 并返回 `x` 和 10 相加的结果\r\n- 在 `foo` 里声明函数 `baz` 接收参数 `x`和 `y`, 并返回 `x` 和 `y` 相加的结果\r\n- 调用 `baz` 函数传入 100 和 2。\r\n- 调用 `console.log` 参数为之前函数调用的返回值。\r\n\r\n![](https://image.fundebug.com/2019-01-21-05.png)\r\n\r\n那么期间发生了什么? 解析器看到 `bar` 函数的声明、`baz` 函数的声明、`bar`函数的调用和 `console.log` 的调用。但是，解析器做了一些完全无关的额外工作即解析 `bar` 函数。为什么这无关紧要? 因为函数 `bar` 从来没有被调用过(或者至少在那个时候没有)。这是一个简单的示例，看起来可能有些不同寻常，但在许多实际应用程序中，许多声明的函数从未被调用。\r\n\r\n这里不解析`bar`函数，该函数声明了却没有调用它。只在需要的时候在函数运行前进行真正的解析。懒解析仍然需要找到函数的整个主体并为其声明，但仅此而已。它不需要语法树，因为它还没有被处理。另外，它不会从堆中分配内存，而堆通常会占用相当多的系统资源，简而言之，跳过这些步骤会带来很大的性能改进。\r\n\r\n所以之前的例子，解析器实际上会像如下这样解析：\r\n\r\n![](https://image.fundebug.com/2019-01-21-06.png)\r\n\r\n注意，这里只确认 `bar` 函数声明，没有进入 `bar` 函数体。在这种情况下，函数体只是一个返回语句。但是，与大多数实际应用程序一样，它可以更大，包含多个返回语句、条件语句、循环、变量声明，甚至嵌套函数声明。这完全是在浪费时间和系统资源，因为这个函数永远不会被调用。\r\n\r\n这是一个相当简单的概念，但实际上，它的实现是非常难的，不局限于以上示例。整个方法还可以适用于函数、循环、条件、对象等。基本上，所有需要解析的东西。\r\n\r\n例如，下面是一个非常常见的 JavaScript 模式。\r\n\r\n```javascript\r\nvar myModule = (function() {\r\n     // 整个模块的逻辑\r\n     // 返回模块对象\r\n})();\r\n```\r\n\r\n大多数现代 JavaScript 解析器都能识别这种模式，此模式表示代码需要立即解析。\r\n\r\n那么为什么解析器不都使用懒解析呢? 如果懒解析某些代码，这些代码需要立即执行，这实际上会使代码运行速度变慢。需要运行一次懒解析之后进行另一个立即解析，这和立即解析相比，运行速度会慢 50%。\r\n\r\n现在对解析器底层原理有了大致的了解，是时候考虑如何提高解析器的解析速度。可以用这种方式编写代码，以便在正确的时间解析函数。大多数解析器都能识别一种模式:使用括号封装函数。对于解析器来说，这几乎总是一个积极的信号，即函数需要立即执行。如果解析器看到一个左括号，紧接着是一个函数声明，它将立即解析这个函数。可以通过显式地声明立即执行的函数来帮助解析器加快解析速度。\r\n\r\n假设有一个名为 `foo` 的函数。\r\n\r\n```javascript\r\nfunction foo(x) {\r\n    return x * 10;\r\n}\r\n```\r\n\r\n因为没有明显地标识表明需要立即运行该函数所以浏览器会进行懒解析。然而，我们确定这是不对的，那么可以运行两个步骤。\r\n\r\n首先，将函数存储在一个变量中:\r\n\r\n```javascript\r\nvar foo = function foo(x) {\r\n    return x * 10;\r\n};\r\n```\r\n\r\n注意，这里有使用函数的名称 `foo`,这不是必需的，但是建议这样做，因为在抛出异常的情况下，stacktrace 会保留实际函数名称，而不仅仅是 `<anonymous>`。\r\n\r\n以上事例解析器执行懒解析，可以用括号封装起来，让解析器进行立即解析：\r\n\r\n```javascript\r\nvar foo = (function foo(x) {\r\n    return x * 10;\r\n});\r\n```\r\n\r\n现在，解析器看见 `function` 关键字前的左括号便会立即进行解析。\r\n\r\n因为需要知道解析器在哪些情况下执行懒解析或者立即解析，所以很难手动管理。此外，还需要花时间考虑是否立即调用某个函数，肯定没人想这么做的。\r\n\r\n最后，这种地让代码更难阅读和理解。可以使用 `Optimize.js` 可以帮我们做这类事情，该工具只是用来优化 JavaScript 源代码的初始加载时间，它们对代码进行静态分析，然后通过使用括号封装需要立即运行的函数以便浏览器立即解析并准备运行它们。\r\n\r\n像往常一样编码，然后有一段代码看起来像这样的：\r\n\r\n```javascript\r\n(function() {\r\n    console.log('Hello, World!');\r\n})();\r\n```\r\n\r\n一切看起来都很好，如预期的那样工作，而且速度很快，因为在函数声明之前添加左括号。当然，在进入生产环境之前需要进行代码压缩，以下为压缩工具的输出：\r\n\r\n```javascript\r\n!function(){console.log('Hello, World!')}();\r\n```\r\n\r\n好像没问题，代码像以前一样工作。但是好像少了什么，压缩工具删除包裹函数的括号，而是在函数前放置了一个感叹号，这意味着解析器将跳过此并将执行惰解析。\r\n\r\n最重要的是，为了能够执行该函数，它将在懒解析之后立即进行立即解析。 这会使代码运行得更慢，幸运的是，可以利用 `Optimize.js` 来解决此类问题，传给 `Optimize.js` 压缩过的代码会输出如下代码：\r\n\r\n```javascript\r\n!(function(){console.log('Hello, World!')})();\r\n\r\n```\r\n\r\n这还差不多，现在拥有两全其美方案：压缩代码且解析器正确地识别懒解析和立即解析的函数。\r\n\r\n### 预编译\r\n\r\n但为什么不能在服务器端完成所有这些工作呢？ 毕竟，最好这样做一次并将结果提供给客户端，而不强制各个客户端重复做该项事情。那么，目前正在讨论引擎是否应该提供一种执行预编译脚本的方法，这样就可以节省浏览器运行时间。\r\n\r\n从本质上讲，该思路是拥有可以生成字节码的务器端工具，这样只需要传输字节码并在客户端运行，之后会看到启动时间的一些主要差异。 这可能听起来很诱人，但事情并非那么简单，还可能会产生相反的效果，因为它会更大，并且很可能需要签署代码并出于安全原因对其进行处理。 例如，V8 团队正在努力解决重复解析问题，这样预编译有可能实际并没有多大的用处。\r\n\r\n### 提升编译速度一些建议\r\n\r\n- 检查依赖，减少不必要的依赖\r\n- 分割代码为更小的块而不是一整陀的\r\n- 尽可能推迟加载 JavaScript，按需要加载或者动态加载。\r\n- 使用开发者工具和 DeviceTiming 来检测性能瓶颈\r\n- 用像 Optimize.js 的工具来帮助解析器选择立即解析或者懒解析以加快解析速度\r\n\r\n**原文：[How JavaScript works: Parsing, Abstract Syntax Trees (ASTs) + 5 tips on how to minimize parse time](https://blog.sessionstack.com/how-javascript-works-parsing-abstract-syntax-trees-asts-5-tips-on-how-to-minimize-parse-time-abfcf7e8a0c8)**\r\n\r\n### 关于Fundebug\r\n\r\n[Fundebug](https://www.fundebug.com/)专注于JavaScript、微信小程序、微信小游戏、支付宝小程序、React Native、Node.js和Java线上应用实时BUG监控。 自从2016年双十一正式上线，Fundebug累计处理了9亿+错误事件，付费客户有Google、360、金山软件、百姓网等众多品牌企业。欢迎大家[免费试用](https://www.fundebug.com/team/create)！\r\n\r\n![](https://static.fundebug.cn/wechat_slogan.png)",title:"JavaScript的工作原理：解析、抽象语法树（AST）+ 提升编译速度5个技巧",last_reply_at:"2019-01-30T07:11:36.286Z",good:e,top:r,reply_count:7,visit_count:1103,create_at:"2019-01-22",author:{loginname:"Fundebug",avatar_url:"https://avatars2.githubusercontent.com/u/26496557?v=4&s=120"}},{id:"5c50213fa4647e02328f21f8",author_id:"57bbcb58b32043f532d40e6f",tab:t,content:"最近想学个 node 框架（支持 ts），发现这仨框架应该算是比较流行的了（express 略古老，koajs 还要自己拼装插件）。\r\n\r\n不知道这三个框架哪一个比较合适？\r\n\r\n打算的架构是 nodejs + redis + mongodb/mysql。",title:"Egg.js/thinkjs/nestjs 该如何选择？",last_reply_at:"2019-01-30T06:57:06.865Z",good:r,top:r,reply_count:11,visit_count:309,create_at:a,author:{loginname:"JZLeung",avatar_url:"https://avatars2.githubusercontent.com/u/7995232?v=4&s=120"}},{id:"5c4d1177f9075c1ef7138710",author_id:"55c8131739273b9219336439",tab:n,content:'尊敬的各位 CNODE 的观众朋友们大家好， 非常抱歉将非 Node 相关的 Elixir 以及 React 的内容悍然插入到这里, 但是鉴于 Node 和 React 的特殊关系以及 Node 在前端开发基础设施界的地位，更考虑到 cnodejs 社区一贯开放包容的优雅气质，还望各位管理员网开一面。。\r\n\r\n在开始各种流水账之前，先附上我一年来细心打磨的项目：coderplanets (为省电以下简称 CPS)\r\n\r\n网站地址: https://coderplanets.com\r\n\r\nGithub源码： [前端](https://github.com/coderplanets/coderplanets_web)， [后端](https://github.com/coderplanets/coderplanets_server)， [管理端](https://github.com/coderplanets/coderplanets_admin)\r\n\r\n![image](https://user-images.githubusercontent.com/6184465/51784903-0afc7a00-218b-11e9-8ddb-08cf4df106f9.png)\r\n\r\n![image](https://user-images.githubusercontent.com/6184465/51784915-2ff0ed00-218b-11e9-8bfd-2c11a5966603.png)\r\n\r\n![demo](https://user-images.githubusercontent.com/6184465/51785962-c11a9080-2198-11e9-89ef-f2d5d874c490.gif)\r\n\r\n\r\n![demo2](https://user-images.githubusercontent.com/6184465/51785972-d55e8d80-2198-11e9-8b63-74b3736919bb.gif)\r\n\r\n\r\n> 如标题所示，网站目前还是雏形且处于内侧阶段，因此各种小问题难以避免，若您不幸踩雷恳请[提交issue](https://github.com/coderplanets/coderplanets_web/issues/new), 我会第一时间修复。\r\n\r\n## coderplanets 是什么?\r\n\r\ncoderplanets.com 是一个主要面向 IT 从业者的聚合社区, 灵感来源于 [feedly](https://feedly.com)、[reddit](https://www.reddit.com) 、[frame.io](https://frame.io/) 等优秀网站以及最主要的: **程序员每天都在使用的文本编辑器**。 简单的讲，她是一个由各种按照编程语言、框架、开发工具、兴趣爱好等**独立的平等且个性化的**子社区组成的社区平台。\r\n\r\n\r\n## 为什么要做这样的社区？\r\n\r\n长话短说，源于我之前在学习一些小众语言时，很难在网上找到像样的可以交流的地方, 本就不多的资料分散在各处，有价值的内容甚至多集中于知乎或简书这样的通用写作平台上，看起来很不方便，以 Elixir 为例, 在[知乎上搜索 Elixir](https://www.zhihu.com/search?type=content&q=elixir), 得到的 Elixir 护肤品问答结果甚至要多于 Elixir 语言本身；比如简书类的平台总喜欢在内容页下大面积"智能推荐"一些[莫名其妙的内容](https://www.jianshu.com/p/bbba1cae9001)等等， 令人十分尴尬; 再比如这类平台都几乎只有”帖子”这一种展现形式等等。(类似平台的类似问题至少还能写两页纸，这里不多展开)。\r\n\r\n不只是 Elixir, 几乎所有的小众语言/框架都面临这样的问题， 通用的平台其实不太适合讨论小众的问题，小众的论坛又基本是业余玩具性质(就比如 [ElixirChina](http://elixir-china.com/)), 不是每个小众语言/框架都有 cnodejs 这样的高质量论坛。另外在即使有限的几个论坛之间穿梭， UI/UX和域名的不一致也很容易给人造成困扰。\r\n\r\n当然我不是专业的产品经理，如果你看了觉得没什么共鸣甚至觉得我是杠精也很正常，但是之于我，这确实是实打实的痛点，这些平台的问题也不是改改样式或者简单的 PR 就能解决的, 很多我眼中的痛点都需要作出伤筋动骨的重构, 再加上技术之外的一系列限制, 基本上只剩下自己动手这一个选项了。\r\n\r\n另外，就线上垂直社区而言，IT 从业者可能是最“挑剔”的群体了，如果能服务好这个群体，以后再建立其他垂直社区时就会相对容易一些了（详见下文）。\r\n\r\n## CPS 有哪些特点?\r\n\r\n### 专注、纯粹、简洁\r\n\r\nCPS 由开发者发起，最终面向广大开发者(所谓 `from makers, to makers`), 垂直服务于`IT从业者`这个领域, 同时为过滤细分领域里的噪音，一切设计都基于/围绕独立的子社区打磨而来。\r\n\r\n### 符合直觉的 UI/UX\r\n\r\n基于前后端分离的架构，没有无处不在的重刷页面和不必要的跳转，在保留了SEO能力的前提下，尽可能多的吸取了其他单页应用的众多优点。\r\n\r\n### Hackable \r\n\r\n大到主题、布局，小到订阅社区排序和帖子列表是否显示分割线, CPS 提供了丰富的自定义选项。更重要且自然的，CPS 是完全开源和开放的，你可以添加任何你觉得有意思的功能， 吐槽代码或设计层面的任何细节。\r\n\r\n### 更加现代\r\n\r\n由于没有历史包袱，CPS 不论[前端](https://github.com/coderplanets/coderplanets_web/blob/dev/docs/architecture/intro.zh-CN.md)、[后端](https://github.com/coderplanets/coderplanets_server/blob/dev/docs/architecture/intro.zh-CN.md)还是一些[基础设施](https://github.com/coderplanets/coderplanets_web/blob/dev/docs/js/graphql.zh-CN.md)，都大胆采用了新的技术架构(乃至新的语言), \r\n\r\n### 多种内容展现形式\r\n\r\n除了传统的帖子以外，还有开源项目、视频、招聘，用户地图、cheatsheet、同城等等多种多样的内容展现形式。\r\n\r\n\r\n## 使用了哪些技术栈？\r\n\r\n#### 前端部分([详细](https://github.com/coderplanets/coderplanets_web/blob/dev/package.json))：\r\n\r\n| 框架/库        | 开发   |\r\n| ------------- |-------------|\r\n| [React.js](https://github.com/facebook/react)        | UI view 层   |\r\n| [Next.js](https://github.com/zeit/next.js)        | 同构 react 框架   |\r\n| [Styled-Component](https://github.com/styled-components/styled-components)        | css-in-js 方案   |\r\n| [Apollo-Client](https://github.com/apollographql/apollo-client)        | GraphQL 客户端   |\r\n| [Draft.js](https://github.com/facebook/draft-js)        | MarkDown 编辑器   |\r\n| [Mobx](https://github.com/mobxjs/mobx)        | react 状态管理   |\r\n| [Mobx-State-Tree](https://github.com/mobxjs/mobx-state-tree)        |  Mobx 最佳伴侣   |\r\n| [Rxjs](https://github.com/ReactiveX/rxjs)        |  异步事件管理  |\r\n| [Ramda](https://github.com/ramda/ramda)        |  各种工具函数  |\r\n\r\n----\r\n\r\n| 框架/库        | DevOps   |\r\n| ------------- |-------------|\r\n| [Next.js](https://github.com/zeit/next.js)        | SEO 支持，打包构建等   |\r\n| [Eslint](https://github.com/eslint/eslint) 和它的朋友们        |  语法规范，纠错  |\r\n| [Prettier](https://github.com/prettier/prettier)        |  formatter  |\r\n| [Commitizen](https://github.com/commitizen/cz-cli) | 规范 commit 消息 |\r\n| [Jest](https://github.com/facebook/jest) / [Enzyme](https://github.com/airbnb/enzyme)        |  单元测试  |\r\n| [Cypress](https://github.com/cypress-io/cypress) | 端对端测试 |\r\n| [Travis](https://travis-ci.org/coderplanets/coderplanets_web) | CI 支持 |\r\n| [Sentry](https://sentry.io) | 错误日志搜集 |\r\n| Google-Analysis | 统计分析 |\r\n| Docker | 容器支持(部署在阿里云) |\r\n\r\n\r\n#### 后端部分([详细](https://github.com/coderplanets/coderplanets_server/blob/dev/mix.exs)):\r\n\r\n| 框架/库        | 开发   |\r\n| ------------- |-------------|\r\n| [Phoenix](https://github.com/phoenixframework/phoenix)        |  API 服务器 |\r\n| [Absinthe](https://github.com/absinthe-graphql/absinthe)        |  GraphQL 支持  |\r\n| [Dataloader](https://github.com/absinthe-graphql/dataloader)        |  GraphQL 查询优化 |\r\n| [Postgrex](https://github.com/elixir-ecto/postgrex)     |  PostgreSQL 数据库客户端 |\r\n\r\n-----\r\n\r\n| 框架/库        | DevOps   |\r\n| ------------- |-------------|\r\n| [Apollo-engine](https://engine.apollographql.com)     | GraphQL网关, 监测，缓存等 |\r\n| [ExUnit](https://hexdocs.pm/ex_unit/ExUnit.html)        |  单元测试 / GraphQL 端对端测试 |\r\n| [Credo](https://github.com/rrrene/credo)        |  语法规范  |\r\n| [Dialyxir](https://github.com/jeremyjh/dialyxir)        |  静态代码检测 |\r\n| [Travis](https://travis-ci.org/coderplanets/coderplanets_server) | CI 支持 |\r\n| [Sentry](https://sentry.io) | 错误日志搜集 |\r\n| Docker | 容器支持(部署在阿里云) |\r\n\r\n\r\n这里限于篇幅不再展开，更详细的文档请移步 github ([前端文档](https://github.com/coderplanets/coderplanets_web/tree/dev/docs) 以及 [后端文档](https://github.com/coderplanets/coderplanets_server/tree/dev/docs))\r\n\r\n另外，我会逐步在知乎的专栏上持续分享有关 CPS 在技术、产品、设计上的各种点滴，欢迎关注。\r\n\r\n## 一些花絮/彩蛋\r\n\r\n- 网络/事件模块被命名为 sr71, 名字源于美军的 sr71 黑鸟侦察机\r\n- 多功能搜索框被命名为 Doraemon, 名字源于英译的哆啦A梦(机器猫)\r\n- 可以使用缩写跳转社区, 例如 k8s -> kubernetes, js -> javascript, wasm -> webassembly 等等\r\n- 可以使用快捷键 C-p/C-g/esc 等呼出或隐藏 Doraemon, 就像在emacs, vim, vscode 等编辑器中一样\r\n- 可以在 Doraemon 输入 /theme 切换主题，以及各种类似操作\r\n- 匿名用户的头像是一个可爱的外星人头像\r\n- 不同社区中的成员分布地图有不同的名字， 比如 ruby 社区叫 rubylist, js 社区叫JSer 等等。。\r\n- 在文章中@用户的时候， editor上方会显示所 at 的用户的头像\r\n- 空内容页面会显示”星球老司机”的提示图，该老司机每次的行进方向是随机的\r\n- 打赏界面被模拟成吃 taco 的场景，原因是我喜欢吃 taco\r\n- 多功能滑出组件在某些页面卡顿时会显示巴萨队徽及其足球哲学：Take the Ball, Pass the Ball. -- 我是十年巴萨球迷\r\n- 左侧边栏顶端会根据节日或重大事件显示不同的 logo\r\n- 回复企邮 hello@group.coderplanets.com 的“员工”叫frank, 是的，就是操蛋的 Frank Gallagher\r\n- 页面侧边栏和底部是赞助商的鸣谢/推广, 如果贵公司有这方面的需要，注明来自 cnodejs 会有折扣优惠 :)\r\n- 还有很多(或者说未来还会添加很多)等你来发现 :)\r\n\r\n## 期待你的参与和支持\r\n\r\n![image](https://user-images.githubusercontent.com/6184465/51666005-02276f00-1ff8-11e9-92b5-4626cf6f1463.png)\r\n\r\n\r\nCPS 从 0 到 1 的这一年来一直处于 "one man army" 的状态，这段经历孤独而美妙，付出和收获同样巨大。因此，您的每一次  `issue` / `pr` / `star` / `fork` / `推广` / `捐助` / `赞助` 等等都会被我视作莫大的鼓励和支持，在此先谢过 🌭 。\r\n\r\n\r\n更进一步的，这个项目从一开始在代码层面并不是只针对 CPS 本身，她致力于成为垂直社区界的 “WordPress”, 所依赖的底层通用的架构叫做 [Mastani-Stack](https://github.com/mastani-stack), 她和 CPS 的关系类似于汽车平台和车型的关系，CPS 是 Mastani 平台的第一款“车型”。在 2019 年还计划有以下"车型" (域名都已注册，并非一时兴起)：\r\n\r\n| domain        | content  | prototype |\r\n| ------------- |-------------| --------------|\r\n| top12s.com    |  足球领域的垂直社区 | 以俱乐部, 国家队等子社区组成 |\r\n| motojie.com (摩界)     |  摩托/摩旅领域的垂直社区 |  以摩托旅行，地域，车型等子社区组成 |\r\n| cgplanets.com    |  CG 领域的垂直社区 |  以 C4D, Blender, Maya 等子社区组成 |\r\n| designber.com    |   设计领域的垂直社区 |  待定, 偏向建筑和工业设计 |\r\n\r\n----\r\n和你第一眼看上去的感觉一样，这其中的工作量是巨大的(不仅仅单指技术层面), 什么时候能完成我无法给出具体 schdule, 但我可以向你保证的是, 这些"车型"都会被高水准的制造出来，不会半途而废。\r\n\r\n因此，如果你恰好也对这些领域感兴趣(或者任何你觉得有意思的垂直领域或有意义的非盈利组织), 不管你身处何方, 不论你擅长技术、文案、设计、推广、商务法律等或者其他方面，欢迎与我联系(或留下您的联系方式)，能和志同道合的人一起搞事情是人生最大的乐趣之一。\r\n\r\n最后作为福利，有请我团队的首席美女鼓励师兼中华田园界第一颜值 — 大美女“梅茜” 出场镇帖: \r\n\r\n![image](https://user-images.githubusercontent.com/6184465/51782415-c9f06f80-2162-11e9-9ab1-eed3692b8b12.png)\r\n\r\n预祝各位新年快乐, 2019一起加油 !',title:"基于 Elixir-GraphQL-React 的新一代社区系统设计雏形",last_reply_at:"2019-01-30T06:55:40.933Z",good:r,top:r,reply_count:9,visit_count:382,create_at:"2019-01-27",author:{loginname:"mydearxym",avatar_url:"https://avatars2.githubusercontent.com/u/6184465?v=4&s=120"}},{id:"5c500adfa4647e02328f20d4",author_id:"5c4e697a3819b801aa5a1dde",tab:t,content:"请问下，上传图片，过滤图片格式怎么处理呢？仅仅是根据图片扩展名么?",title:"上传图片，过滤图片格式怎么处理呢？",last_reply_at:"2019-01-30T06:25:07.682Z",good:r,top:r,reply_count:4,visit_count:222,create_at:a,author:{loginname:"hujunyuan8058",avatar_url:"https://avatars3.githubusercontent.com/u/37411247?v=4&s=120"}}],tab:"",loading:r,pageInfo:{page:1,limit:15,total:1e3}},user:{loginInfo:{},userInfo:{},messages:{has_read_messages:[],hasnot_read_messages:[]},accesstoken:"",loading:r}},serverRendered:e}}(!1,"share","ask",!0,"2019-01-29",0,"2019-01-30",0,"2019-01-28")</script><script src="/nuxt-blog/_nuxt/9c11529915801e3bf16a.js" defer></script><script src="/nuxt-blog/_nuxt/33ffe1be6688f2a23cd1.js" defer></script><script src="/nuxt-blog/_nuxt/0a520300744ac3f1fc51.js" defer></script><script src="/nuxt-blog/_nuxt/57fb3943be9a93db42b4.js" defer></script><script src="/nuxt-blog/_nuxt/0ee71a772b0f3afbf38d.js" defer></script>
  </body>
</html>
